<!DOCTYPE html>
<html lang = "en">
    <head>
        <title> Create Blog </title>

        <link rel="stylesheet" href ="Blog.css"/>
    </head>

    <body>
        <h1>The Blog</h1>
        <h2> Create your own blog</h2>
        <div class = "box-container">
    
                <input class= "Newblog" style ="text-align: center; padding: 10px 10px 0 0;" type = "text" placeholder="Hope you Blog something good"; maxlength="140" required></input>
                <button id ="post" type="submit">Post</button>
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', function() {

                // Blog JS is used to handle the blogs that are created by the user 

                const blogInput =document.getElementsByClassName('Newblog')[0];
                const post = document.getElementById('post');

                post.addEventListener("click", async (event) =>{
                    event.preventDefault() ;

                    const blog = blogInput.value;
                    console.log(blog)
                    try {
                    
                    // const response =  await fetch('http://127.0.0.1:3000/api/message', {
                    //         mode: 'no-cors',
                    //         method: 'POST',
                    //         headers: {
                    //             'Content-Type': 'application/json',
                    //         },
                    //         body:  JSON.stringify({blogContent: blog}) ,

                    //     });

                    //     const result =await response.json();
                    //     console.log(result) ;
                        
                    //     alert(result);    
                    
                    var myHeaders = new Headers();
                    myHeaders.append("Content-Type", "application/x-www-form-urlencoded");
                    
                    var urlencoded = new URLSearchParams();
                    urlencoded.append("blog", blog);
                    
                    var requestOptions = {
                    method: 'POST',
                    headers: myHeaders,
                    body: urlencoded,
                    redirect: 'follow'
                    };
                    
                    fetch("http://127.0.0.1:3000/api/message", requestOptions)
                    .then(response => response.text())
                    .then(result => console.log(result))
                    .then(document.querySelector('h2').innerHTML = 'Thanks !')
                    .then(document.getElementsByClassName('box-container')[0].innerHTML = ' Blog is inserted successfully')
                    .catch(error => console.log('error', error));      
                    
                }         
                
                catch (error){
                console.log( 'Error submitting the message'+ error);
                }
                });
                
                });   
        </script>
    </body>

</html>