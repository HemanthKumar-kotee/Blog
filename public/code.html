<!DOCTYPE html> 
<html lang = "en">
    <head>
        <title> The Blog </title>

        <link rel="stylesheet" href ="style.css"/>
    </head>
    <body>
        <div class = "header-container">
            <nav class = "nav-link">
                <ul>     
                    <li><a href = "blog.html" style ="color: white;"> Blog   </a></li> 
                    <li><a href = "user.html" style = "color: white;"> Profile </a> </li>
                    <li><a href = "About.html" style="color:white;">  About   </a></li>
                </ul>
            </nav>        
        </div>
        
    
        <hr style = "width: 80% ;border-top:2px dotted #f2fff2;"> 

            <h1 class="The-Blog">THE - BLOG</h1>
        
        <hr style = "width: 80%; border-top:2px dotted #f2fff2; ">
        
        <div> <h3 class ="recents" > Recent blog posts</h3> 
            <div class = 'recentskeleton'>     </div>
        </div>    
            <button id = "Add-blog" type="button">Create a blog</button>

        
        <div class ='past-blog'>
            <div class= 'past-blog-skeleton'> </div>
        </div>
                
        <script>
            
            document.addEventListener('DOMContentLoaded' ,()=> {

                fetchAndDisplayText();
        
                const create_blog =document.getElementById("Add-blog");

                // The main page of the blog application used to show the blogs to the user 
                /*
                Main JavaScript file used to handle the event listener to 

                    make reliable to the user of the blog application
                */ 

                create_blog.addEventListener("click", ()=>{

                    window.location.href = "http://127.0.0.1:3000/blog" ;

                });

                async function fetchAndDisplayText(){
                    console.log("Fetching data from the server...");
                    try{

                        const response = await fetch('http://127.0.0.1:3000/api/fetchText');
                            
                        if (!response.ok) {
                            throw new Error('Response error: ${response.status}');
                        }
                        
                        const data = await response.json();
                        
                        console.log('Data received: ',data);
                           
                            const blogDisplay = document.getElementsByClassName('recentskeleton')[0];

                            data.forEach(blog => {
                                const blogElement = document.createElement('div');

                                blogElement.style.marginTop = '25px';
                                blogElement.style.width = '15%';
                                blogElement.style.height = '10vh';
                                blogElement.style.borderRadius = '20px';
                                blogElement.style.border = '2px solid #0d1a1a';
                                blogElement.textContent = blog;
                                blogDisplay.appendChild(blogElement);

                            });
                        } catch (error) {

                        console.error('Unable to fetch data from the server! ',error);
                    }
                }   
            });
        
        </script>
    </body>

</html>